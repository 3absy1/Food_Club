<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Simple Login Form Example</title>
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Rubik:400,700'><link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<div class="login-form">
  <form>
    <h1>تسجيل الدخول </h1>
    <div class="content">
      <div class="input-field">
        <input type="email" id="emaill" placeholder="البريد الالكترونى" autocomplete="nope">
      </div>
      <div class="input-field">
        <input type="password" id="passwordd" placeholder="كلمة السر" autocomplete="new-password">
      </div>
    </div>
    

  </form>
  <div class="action">
    <button type="submit" id="signIn" name="signin" onclick="getdata()">تسجيل الدخول</button>
  </div>
</div>
<!-- partial -->
  <script  src="./script.js"></script>

  <script>
    function getdata(){
    var fastname=document.getElementById("emaill").value;
    localStorage.setItem("textvalue",fastname);
    return false;
    }
  //   function send(){
  // 	var fastname=document.getElementById("email").value;
  // 	localStorage.setItem("textvalue",fastname);
  // 	return false;
  //   }
  </script>

</body>
<script type="module">
	// Import the functions you need from the SDKs you need
	import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
	import { getDatabase ,set ,ref,update} from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";
	import { getAuth, createUserWithEmailAndPassword,signInWithEmailAndPassword  } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";


	// TODO: Add SDKs for Firebase products that you want to use
	// https://firebase.google.com/docs/web/setup#available-libraries
  
	// Your web app's Firebase configuration
	const firebaseConfig = {
	  apiKey: "AIzaSyCDajRe6q98Of6b7sNcKbpMU-88ube3gcg",
	  authDomain: "finalproject-93617.firebaseapp.com",
	  databaseURL: "https://finalproject-93617-default-rtdb.firebaseio.com",
	  projectId: "finalproject-93617",
	  storageBucket: "finalproject-93617.appspot.com",
	  messagingSenderId: "429854078677",
	  appId: "1:429854078677:web:3b8bd691663d9e918b945c"
	};
  
	// Initialize Firebase
	const app = initializeApp(firebaseConfig);
	const database = getDatabase(app);
	const auth = getAuth();

  //sign in *******************************************************

	signIn.addEventListener('click',(e) =>{
     var emaill = document.getElementById('emaill').value;
     var passwordd = document.getElementById('passwordd').value;


	 signInWithEmailAndPassword(auth, emaill, passwordd)
  .then((userCredential) => {
    // Signed in 
    const user = userCredential.user;
    localStorage.setItem("userid",user.uid);

	const dt=new Date();
	update(ref(database, 'restuarant/' + user.uid),{
	last_login: dt,
})

	alert(' Login Successful')
    window.location.href="F:/Foooody%23@/FOO0DY%23%20%20with%20out%20login/RESADMIN/pages/product/addproduct.html";


    // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
	alert(errorMessage);
    // ..
  });
	});


  </script>

</html>
