<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Login and Signup</title>
  <link rel="stylesheet" href="./style.css">
 
 <link rel="stylesheet" href="build/css/intlTelInput.css">
 <link rel="icon" type="image/png" sizes="32x32" href="images/274506004_436002001581432_7956343886707801994_n.jpg">


</head>
<body>
	
  

<!-- partial:index.partial.html -->
<div id="container" class="container">
		<!-- FORM SECTION -->
		<div class="row">
			<!-- SIGN UP -->
			<div class="col align-items-center flex-col sign-up">
				<div class="form-wrapper align-items-center">
					<div class="form sign-up">
						<div class="input-group">
							<i class='bx bxs-user'></i>
							<input type="text" placeholder="اسم المستخدم"id="username">
						</div>
						<div class="input-group">
							<i class='bx bx-mail-send'></i>
							<input type="email" placeholder="البريد الالكتروني"id="email">
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<input type="password" placeholder="كلمة السر " id="password">
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<input type="password"  placeholder="تأكيد كلمة السر" id="confirmpassword">
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<input type="date" id="birthday" name="birthday"placeholder="Date Of Birth">
							
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<form>
							<input id="phone" name="phone" type="tel">
						</form>
							
						</div>
						<button type="submit" id="signUp">
							انشاء حساب
						</button>
						
							<span>
								لديك حساب بلفعل؟
							</span>
							<b onclick="toggle()" class="pointer">
								تسجيل دخول
							</b>
						</p>
					</div>
				</div>
			
			</div>
			<!-- END SIGN UP -->
			<!-- SIGN IN -->
			
			<div class="col align-items-center flex-col sign-in">
				<a id="whit" href="F:/Foooody%23/FOO0DY%23%20%20with%20out%20login/index3.html">English</a>

				<div class="form-wrapper align-items-center">
					<div class="form sign-in">
						<div class="input-group">
							<i class='bx bxs-user'></i>
							<input type="email" id="emaill" placeholder="اسم المستخدم">
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<input type="password" id="passwordd" placeholder="كلمة السر">
						</div>
						<!--<a href="E:/Foooody%23/FOO0DY%23/index1.html">-->
							<button type="submit" id="signIn">تسجيل الدخول</button>
						
					</a> 
						
						<p>
							<span>
								ليس لديك حساب ؟
							</span>
							<b onclick="toggle()" class="pointer">
								انشاء حساب
							</b>
						</p>
						
					</div>
				
					
				</div>
				<!--<button onclick="signOut()" id="signOut">Sign out</button>-->
				


				<br>
				<br>
				<h2 id="sign"> او سجل عن طريق </h2>
				<div id="signin">
				<a id="facebook" href="#"><img id="face" src="images/logo-facebook.png"  alt="images"></a>
				<a id="google" href="#"><img id="google" src="images/goog.png" alt="images"></a>
			    </div>
				<div class="form-wrapper">
		
				</div>
			</div>
			<!-- END SIGN IN -->
		</div>
		<!-- END FORM SECTION -->
		<!-- CONTENT SECTION -->
		<div class="row content-row">
			<!-- SIGN IN CONTENT -->
			<div class="col align-items-center flex-col">
				<div class="text sign-in">
					<h2>
						مرحباً
					</h2>
	
				</div>
				<div class="img sign-in">
		
				</div>
			</div>
			<!-- END SIGN IN CONTENT -->
			<!-- SIGN UP CONTENT -->
			<div class="col align-items-center flex-col">
				<div class="img sign-up">
				
				</div>
				<div class="text sign-up">
					<h2>
						انضم لنا 
					</h2>
	
				</div>
			</div>
			<!-- END SIGN UP CONTENT -->
		</div>
		<!-- END CONTENT SECTION -->
	</div>
<!-- partial -->
  <script  src="./script.js"></script>
  <script src="build/js/intlTelInput.js"></script>
  <script>
    var input = document.querySelector("#phone");
    window.intlTelInput(input, {
      // allowDropdown: false,
      // autoHideDialCode: false,
      // autoPlaceholder: "off",
      // dropdownContainer: document.body,
      // excludeCountries: ["us"],
      // formatOnDisplay: false,
      // geoIpLookup: function(callback) {
      //   $.get("http://ipinfo.io", function() {}, "jsonp").always(function(resp) {
      //     var countryCode = (resp && resp.country) ? resp.country : "";
      //     callback(countryCode);
      //   });
      // },
      // hiddenInput: "full_number",
      // initialCountry: "auto",
      // localizedCountries: { 'de': 'Deutschland' },
      // nationalMode: false,
      // onlyCountries: ['us', 'gb', 'ch', 'ca', 'do'],
      // placeholderNumberType: "MOBILE",
      // preferredCountries: ['cn', 'jp'],
      // separateDialCode: true,
      utilsScript: "build/js/utils.js",
    });
  </script>

</body>
<script type="module">
	// Import the functions you need from the SDKs you need
	import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
	import { getDatabase ,set ,ref,update} from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";
	import { getAuth, createUserWithEmailAndPassword,signInWithEmailAndPassword  } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";


	// TODO: Add SDKs for Firebase products that you want to use
	// https://firebase.google.com/docs/web/setup#available-libraries
  
	// Your web app's Firebase configuration
	const firebaseConfig = {
	  apiKey: "AIzaSyCDajRe6q98Of6b7sNcKbpMU-88ube3gcg",
	  authDomain: "finalproject-93617.firebaseapp.com",
	  databaseURL: "https://finalproject-93617-default-rtdb.firebaseio.com",
	  projectId: "finalproject-93617",
	  storageBucket: "finalproject-93617.appspot.com",
	  messagingSenderId: "429854078677",
	  appId: "1:429854078677:web:3b8bd691663d9e918b945c"
	};
  
	// Initialize Firebase
	const app = initializeApp(firebaseConfig);
	const database = getDatabase(app);
	const auth = getAuth();

	signUp.addEventListener('click',(e) =>{
     var email = document.getElementById('email').value;
     var password = document.getElementById('password').value;
     var username= document.getElementById('username').value;
     var confirmpassword= document.getElementById('confirmpassword').value;
     var birthday= document.getElementById('birthday').value;
     var phone= document.getElementById('phone').value; 

	 if(valdition_field(username)==false||valdition_field(birthday)==false||valdition_field(phone)==false||valdition_field(confirmpassword)==false){
      alert('يوجد مكان فارغ')
      return
     }
	//  else if(valdition_email(email)==false || valdition_password(password)==false){
    //   alert('Email and Password is Outta Line')
    //   return
    //   //don't run the code 

    // }
	else if(password!=confirmpassword){
		alert('ليس نفس كلمه السر')
		return
	}
	 else{

	createUserWithEmailAndPassword(auth, email, password)
  .then((userCredential) => {
    // Signed up 
    const user = userCredential.user;
	set(ref(database, 'users/' + user.uid),{
		username: username,
		email:email,
		password:password,
		confirmpassword:confirmpassword,
		birthday:birthday,
		phone: phone,

	})
	alert('user created!');
	window.location.href="F:/Foooody%23/FOOD%20CLUB%20(arabic)/FOO0DY%23/index1.html";
    // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
	alert(errorMessage);
    // ..
  });
}
	});

	//**************************************************************

	//sign in *******************************************************

	signIn.addEventListener('click',(e) =>{
     var emaill = document.getElementById('emaill').value;
     var passwordd = document.getElementById('passwordd').value;


	 signInWithEmailAndPassword(auth, emaill, passwordd)
  .then((userCredential) => {
    // Signed in 
    const user = userCredential.user;

	const dt=new Date();
	update(ref(database, 'users/' + user.uid),{
	last_login: dt,
})

	alert('User Login Successful')
    window.location.href="F:/Foooody%23/FOOD%20CLUB%20(arabic)/FOO0DY%23/index1.html";


    // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
	alert(errorMessage);
    // ..
  });
	});

	 //valdition
	 function valdition_email(email){
   expression= /^[^@]+@\w+(\.\w+)+\w$/;
   if(expression.test(email) == true){
     return true
   }else{
     return false
   }
  }
  function valdition_password(password){
    if (password<=8){
      return false
    }else{
      return true
    }
  }
  function valdition_field(filed){
    if(filed==null){
      return false
    }
    if(filed<=0){
      return false
    }else{
      return true
    }
  }




// 	signIn.addEventListener('click',(e) =>{
// 	var emaill = document.getElementById('emaill').value;
//     var passwordd = document.getElementById('passwordd').value;
// 	signInWithEmailAndPassword(auth, emaill, passwordd)
//     .then((userCredential) => {
//     // Signed in 
//     const user = userCredential.user;

// 	const dt=new Date();
// 	updata(ref(database, 'users/' + user.uid),{
// 	last_login_date:dt,
// })
// alert('User Login Successful');
//     // ...
//   })
//   .catch((error) => {
//     const errorCode = error.code;
//     const errorMessage = error.message;
// 	alert('errorMessage');

//   });


// 	});



  </script>
</html>
